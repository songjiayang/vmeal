/*******************************************************************************
* KindEditor - WYSIWYG HTML Editor for Internet
* Copyright (C) 2006-2011 kindsoft.net
*
* @author Roddy <luolonghao@gmail.com>
* @site http://www.kindsoft.net/
* @licence http://www.kindsoft.net/license.php
*******************************************************************************/
KindEditor.plugin("emoticons",function(e){var t=this,n="emoticons",r=t.emoticonsPath||t.pluginsPath+"emoticons/images/",i=t.allowPreviewEmoticons===undefined?!0:t.allowPreviewEmoticons,s=1;t.clickToolbar(n,function(){function y(n,i,s){m?n.mouseover(function(){i>h?(m.css("left",0),m.css("right","")):(m.css("left",""),m.css("right",0)),g.attr("src",r+s+".gif"),e(this).addClass("ke-on")}):n.mouseover(function(){e(this).addClass("ke-on")}),n.mouseout(function(){e(this).removeClass("ke-on")}),n.click(function(e){t.insertHtml('<img src="'+r+s+'.gif" border="0" alt="" />').hideMenu().focus(),e.stop()})}function b(t,n){var i=document.createElement("table");n.append(i),m&&(e(i).mouseover(function(){m.show("block")}),e(i).mouseout(function(){m.hide()}),d.push(e(i))),i.className="ke-table",i.cellPadding=0,i.cellSpacing=0,i.border=0;var s=(t-1)*l+f;for(var a=0;a<o;a++){var c=i.insertRow(a);for(var h=0;h<u;h++){var p=e(c.insertCell(h));p.addClass("ke-cell"),y(p,h,s);var v=e('<span class="ke-img"></span>').css("background-position","-"+24*s+"px 0px").css("background-image","url("+r+"static.gif)");p.append(v),d.push(p),s++}}return i}function E(){e.each(d,function(){this.unbind()})}function x(e,t){e.click(function(e){E(),w.parentNode.removeChild(w),S.remove(),w=b(t,p),T(t),s=t,e.stop()})}function T(t){S=e('<div class="ke-page"></div>'),p.append(S);for(var n=1;n<=c;n++){if(t!==n){var r=e('<a href="javascript:;">['+n+"]</a>");x(r,n),S.append(r),d.push(r)}else S.append(e("@["+n+"]"));S.append(e("@&nbsp;"))}}var o=5,u=9,a=135,f=0,l=o*u,c=Math.ceil(a/l),h=Math.floor(u/2),p=e('<div class="ke-plugin-emoticons"></div>'),d=[],v=t.createMenu({name:n,beforeRemove:function(){E()}});v.div.append(p);var m,g;i&&(m=e('<div class="ke-preview"></div>').css("right",0),g=e('<img class="ke-preview-img" src="'+r+f+'.gif" />'),p.append(m),m.append(g));var w=b(s,p),S;T(s)})});